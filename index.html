<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://router.project-osrm.org/route/v1/driving/"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    html, body { margin: 0; padding: 0; height: 100%; }
    #map { height: 100%; width: 100%; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    let map = L.map('map').setView([41.3275, 19.8189], 13);
    
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const vehicleIcons = [
      L.icon({ iconUrl: 'https://raw.githubusercontent.com/Klajdi424/image/refs/heads/main/OIP__5_-removebg-preview.png', iconSize: [40, 40] }),
      L.icon({ iconUrl: 'https://raw.githubusercontent.com/Klajdi424/image/refs/heads/main/OIP__6_-removebg-preview.png', iconSize: [40, 40] }),
      L.icon({ iconUrl: 'https://raw.githubusercontent.com/Klajdi424/image/refs/heads/main/OIP__7_-removebg-preview.png', iconSize: [40, 40] }),
      L.icon({ iconUrl: 'https://raw.githubusercontent.com/Klajdi424/image/refs/heads/main/driver.png', iconSize: [40, 40] })
    ];

    function getRandomPoint(center, radius) {
      let y0 = center.lat, x0 = center.lng;
      let rd = radius / 111300;
      let u = Math.random(), v = Math.random();
      let w = rd * Math.sqrt(u), t = 2 * Math.PI * v;
      let y = y0 + w * Math.sin(t), x = x0 + w * Math.cos(t);
      return [y, x];
    }

    function moveVehicle(vehicle, route) {
      let index = 0;
      function move() {
        if (index < route.length) {
          vehicle.setLatLng(route[index]);
          index++;
          setTimeout(move, 2000); 
        }
      }
      move();
    }

    function addVehicle() {
      let start = getRandomPoint({ lat: 41.3275, lng: 19.8189 }, 3000);
      let end = getRandomPoint({ lat: 41.3275, lng: 19.8189 }, 3000);
      let vehicle = L.marker(start, { icon: vehicleIcons[Math.floor(Math.random() * vehicleIcons.length)] }).addTo(map);
      
      fetch(`https://router.project-osrm.org/route/v1/driving/${start[1]},${start[0]};${end[1]},${end[0]}?overview=full&geometries=geojson`)
        .then(response => response.json())
        .then(data => {
          let route = data.routes[0].geometry.coordinates.map(coord => [coord[1], coord[0]]);
          moveVehicle(vehicle, route);
        });
    }
    
    for (let i = 0; i < 10; i++) {
      addVehicle();
    }
  </script>
</body>
</html>
